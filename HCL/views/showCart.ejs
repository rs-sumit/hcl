<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>Cart | FoodHub</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style.css"/>
</head>

<body>

    <!-- NAVBAR -->
    <header class="site-header">
        <%-include("navbar.ejs")%>
    </header>

    <!-- CART PAGE -->
    <main class="cart-page">
        <div class="container cart-layout">

            <!-- LEFT: CART ITEMS -->
            <section class="cart-items">
                <h1 class="cart-title">Your Cart</h1>

                <!-- Cart Item 1 -->
                <article class="cart-item" data-price="240">
                    <div class="cart-item__info">
                        <img src="https://images.unsplash.com/photo-1548369937-47519962c11a?auto=format&fit=crop&w=600&q=80"
                            alt="Margherita Pizza" />
                        <div>
                            <h2>Margherita Pizza</h2>
                            <p>Classic cheese & tomato with basil.</p>
                        </div>
                    </div>

                    <div class="cart-item__unit">
                        <span class="label">Price</span>
                        <span class="value">₹240</span>
                    </div>

                    <div class="cart-item__qty">
                        <span class="label">Qty</span>
                        <div class="qty-control">
                            <button type="button" class="qty-btn minus">−</button>
                            <input type="number" class="qty-input" value="1" min="1" />
                            <button type="button" class="qty-btn plus">+</button>
                        </div>
                    </div>

                    <div class="cart-item__subtotal">
                        <span class="label">Subtotal</span>
                        <span class="value subtotal-value">₹240</span>
                    </div>
                </article>

                <!-- Cart Item 2 -->
                <article class="cart-item" data-price="80">
                    <div class="cart-item__info">
                        <img src="https://images.unsplash.com/photo-1613478223719-2ab802602423?auto=format&fit=crop&w=600&q=80"
                            alt="Cola (500ml)" />
                        <div>
                            <h2>Cola (500ml)</h2>
                            <p>Chilled soft drink bottle.</p>
                        </div>
                    </div>

                    <div class="cart-item__unit">
                        <span class="label">Price</span>
                        <span class="value">₹80</span>
                    </div>

                    <div class="cart-item__qty">
                        <span class="label">Qty</span>
                        <div class="qty-control">
                            <button type="button" class="qty-btn minus">−</button>
                            <input type="number" class="qty-input" value="2" min="1" />
                            <button type="button" class="qty-btn plus">+</button>
                        </div>
                    </div>

                    <div class="cart-item__subtotal">
                        <span class="label">Subtotal</span>
                        <span class="value subtotal-value">₹160</span>
                    </div>
                </article>

                <!-- Cart Item 3 -->
                <article class="cart-item" data-price="120">
                    <div class="cart-item__info">
                        <img src="https://images.unsplash.com/photo-1585238341267-1c0a65fa3d0b?auto=format&fit=crop&w=600&q=80"
                            alt="Garlic Bread" />
                        <div>
                            <h2>Garlic Bread</h2>
                            <p>Freshly baked garlic bread with herbs.</p>
                        </div>
                    </div>

                    <div class="cart-item__unit">
                        <span class="label">Price</span>
                        <span class="value">₹120</span>
                    </div>

                    <div class="cart-item__qty">
                        <span class="label">Qty</span>
                        <div class="qty-control">
                            <button type="button" class="qty-btn minus">−</button>
                            <input type="number" class="qty-input" value="1" min="1" />
                            <button type="button" class="qty-btn plus">+</button>
                        </div>
                    </div>

                    <div class="cart-item__subtotal">
                        <span class="label">Subtotal</span>
                        <span class="value subtotal-value">₹120</span>
                    </div>
                </article>
            </section>

            <!-- RIGHT: SUMMARY -->
            <aside class="cart-summary">
                <h2>Order Summary</h2>

                <div class="summary-row">
                    <span>Items Total</span>
                    <span id="itemsTotal">₹520</span>
                </div>

                <div class="summary-row">
                    <span>Delivery</span>
                    <span>Free</span>
                </div>

                <div class="summary-row summary-row--total">
                    <span>Final Total</span>
                    <span id="finalTotal">₹520</span>
                </div>
                <a  href="http://localhost:8080/address">
                    <button type="button" class="cart-submit-btn">
                        Proced Order
                    </button>
                </a>
                
            </aside>
        </div>
    </main>

    <footer class="site-footer">
        <div class="container">
            <p>© 2025 FoodHub. All rights reserved.</p>
        </div>
    </footer>

    <!-- SIMPLE JS FOR DYNAMIC TOTALS -->
    <script>
        function updateCartTotals() {
            const cartItems = document.querySelectorAll('.cart-item');
            let total = 0;

            cartItems.forEach(item => {
                const price = parseFloat(item.dataset.price);
                const qtyInput = item.querySelector('.qty-input');
                let qty = parseInt(qtyInput.value, 10);
                if (isNaN(qty) || qty < 1) {
                    qty = 1;
                    qtyInput.value = 1;
                }
                const subtotal = price * qty;
                item.querySelector('.subtotal-value').textContent = '₹' + subtotal;
                total += subtotal;
            });

            document.getElementById('itemsTotal').textContent = '₹' + total;
            document.getElementById('finalTotal').textContent = '₹' + total;
        }

        function procedOrder() {
            // Later: replace with real order submission (POST to backend)
            alert('Order submitted! (Here we will call backend API)');
        }

        // Attach events
        document.addEventListener('DOMContentLoaded', () => {
            const cartItems = document.querySelectorAll('.cart-item');

            cartItems.forEach(item => {
                const minusBtn = item.querySelector('.qty-btn.minus');
                const plusBtn = item.querySelector('.qty-btn.plus');
                const qtyInput = item.querySelector('.qty-input');

                minusBtn.addEventListener('click', () => {
                    let value = parseInt(qtyInput.value, 10) || 1;
                    if (value > 1) {
                        qtyInput.value = value - 1;
                        updateCartTotals();
                    }
                });

                plusBtn.addEventListener('click', () => {
                    let value = parseInt(qtyInput.value, 10) || 1;
                    qtyInput.value = value + 1;
                    updateCartTotals();
                });

                qtyInput.addEventListener('change', updateCartTotals);
            });

            // Initial calculation
            updateCartTotals();
        });
    </script>
</body>

</html>